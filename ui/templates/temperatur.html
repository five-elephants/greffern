{% extends "base.html" %}
{% block title %} {{ super() }} - Temperatur {% endblock %}

{% block styles %}
    {{ super() }}
    {% for css in resources.css_files %}
        <link href="{{ css }}" rel="stylesheet">
    {% endfor %}
    {% for css_raw in resources.css_raw %}
        <style>{{ css_raw }}</style>
    {% endfor %}
{% endblock %}

{% block scripts %}
    {% for js in resources.js_files %}
        <script src="{{ js }}"></script>
    {% endfor %}
    {% for js_raw in resources.js_raw %}
        <script>{{ js_raw|safe }}</script>
    {% endfor %}
    {{ script|safe }}
    {{ super() }}
{% endblock %}

{% block content %}
<div class="container">
<div class="row">
    <div class="col-md-12">
        <h1>Temperatur</h1>
    </div>
</div>

<div class="row">
    <div class="col-xs-7">
        {{ div|safe }}
    </div>

    <div class="col-xs-5">

<h2>Sensoren und Alarme</h2>

<table class="table table-condensed table-striped">
    <thead>
        <tr>
            <td> UID </td>
            <td> Name </td>
            <td> Ort </td>
        </tr>
    </thead>
    <tbody>
        {% for sensor in sensors %}
            <tr>
                <td> {{ sensor.uid }} </td>
                <td> {{ sensor.name }} </td>
                <td> {{ sensor.location }} </td>
            </tr>
            {% if sensor.alerts %}
            <tr>
                <td colspan="3">
                    <dl>

{% for alert in sensor.alerts %}
    <dt>{{ alert.name }} (<a href="/del_alert/{{ alert.id }}">Löschen</a>)</dt>
    <dd>
Sende Nachricht an <em>{{ alert.notify_email }}</em>,
{% if alert.above_trigger is not none %}
    wenn Temperatur <strong>über {{ alert.above_trigger }} °C</strong>
    {% if alert.below_trigger is not none %}
        oder
    {% endif %}
{% endif %}
{% if alert.below_trigger is not none %}
    wenn Temperatur <strong>unter {{ alert.below_trigger }} °C</strong>
{% endif %}
    </dd>
{% endfor %}

                    </dl>
                </td>
            </tr>
            {% endif %}
        {% endfor %}
    </tbody>
</table>


<h2>Alarm erstellen</h2>
{{ wtf.quick_form(create_alert_form, method='POST', action='/temperatur') }}

    </div>
</div>
</div>
{% endblock %}
